#!/bin/bash

# Elite Night Mode Toggle - Terminal Edition
# Matches our custom engine perfectly

SERVICE="com.system76.CosmicComp"
OBJ="/com/system76/CosmicComp/NightLight"
IFACE="com.system76.CosmicComp.NightLight"

# Check if a level was provided (1, 2, or 3)
if [[ "$1" =~ ^[1-3]$ ]]; then
    echo "Setting Night Mode to Level $1..."
    busctl --user call $SERVICE $OBJ $IFACE SetLevel y $1
    exit 0
fi

# Otherwise, just toggle
STATUS=$(busctl --user call $SERVICE $OBJ $IFACE Enabled)

if [[ "$STATUS" == *"true"* ]]; then
    echo "Night Mode is ON. Turning it OFF..."
    busctl --user call $SERVICE $OBJ $IFACE SetEnabled b false
else
    echo "Night Mode is OFF. Turning it ON..."
    busctl --user call $SERVICE $OBJ $IFACE SetEnabled b true
fi
